
10万：
Merge, 0.249
Quick, 0.195

Quick, 0.203
QuickX, 0.159

《算法》笔记 4 - 快速排序
- 介绍
- 基本算法
    - 代码
    - 切分方法
    - 性能特点

- 算法改进
    - 切换到插入排序
    - 三取样切分
    - 针对重复元素的优化

本节将要学习的快速排序，可以说是应用最广泛的排序算法了，很多语言如Java、C#的系统排序采用的便是快速排序。快速排序实现简单，而且适用于各种不同的输入数据，且在一般的应用中比其他排序算法都要快得多。快速排序与前面几种排序算法相比其优势在于，它不仅是原地排序算法(只需要一个很小的辅助栈)，而且将长度为N的数组排序所需的时间和NlgN成正比，而之前的几种算法都无法兼具这两个特点。归并排序虽然速度也很快，但它的空间成本却是线性增长的。
快速排序是由C.A.R Hoare在1960年发明的，被誉为20世纪十大算法之一，Hoare本人也因快速排序和其它计算机科学方面的成就而获得1980年的图灵奖。

### 基本算法
快速排序是一种基于分治的排序算法，它的基本思想是将数组分为两半，使左边的一半总是小于某个元素，右边的一半总是大于某个元素，这一过程不断递归下去，直到整个数组变得有序。
代码如下：
```
public class Quick {
    public static void sort(Comparable[] a) {
        StdRandom.shuffle(a);
        sort(a, 0, a.length - 1);
    }

    private static void sort(Comparable[] a, int lo, int hi) {
        if (lo >= hi)
            return;
        int j = partition(a, lo, hi);  //切分方法，待实现
        sort(a, lo, j - 1);  //将左边子数组排序
        sort(a, j + 1, hi);  //将右边边子数组排序
    }

    ...
}
```

快速排序和归并排序是互补的，归并排序也是将数组分成两个子数组分别排序，并将有序的子数组归并以将整个数组排序，递归调用发生在处理整个数组之前；而快速排序将数组排序的方式则是通过让切分元素左右两边的子数组分别小于、大于切分元素，最终整个数组自然就是有序的了，它的递归调用发生在处理整个数组之后。
切分方法partition()的作用是将切分元素a[j]放到其应该呆的位置，然后基于切分元素，会递归地调用sort方法将左右子数组排序。在排序前会先将数组打乱，这样可以让算法的性能免受输入特征的影响。

切分方法的代码为：
```
private static int partition(Comparable[] a, int lo, int hi) {
    int i = lo, j = hi + 1;
    Comparable v = a[i];
    while (true) {
        while (less(a[++i], v)) {   
            if (i == hi)
                break;
        }
        while (less(v, a[--j])) {  
            if (j == lo)
                break;
        }
        if (i >= j)
            break;
        exch(a, i, j);
    }
    exch(a, lo, j);
    return j;
}
```
切分的过程如图：

取a[lo]为切分元素v，指针i,j分别从数组的左右两端开始扫描，从左至右找到一个大于v的元素，从右至左找到一个小于v的元素，这两个元素都是未被排定的，于是交换它俩的位置，然后继续扫描、交换，直到左指针i和右指针j相遇，便完成了一次针对元素v的切分过程，同时v也已经被排定到合适的位置了。每次切分总能排定一个元素，最终便会将所有的元素排到正确的位置。
